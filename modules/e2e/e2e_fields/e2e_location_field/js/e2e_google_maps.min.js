function initMap(){function r(b){function m(a){function n(){0!==l&&l.close();k.open(c,d);l=k}var h=parseFloat(a.getAttribute("data-lat")),A=parseFloat(a.getAttribute("data-lng")),e=a.getElementsByTagName("h4")[0].innerHTML,f=a.hasAttribute("data-marker")?a.getAttribute("data-marker"):"",d=new google.maps.Marker({position:{lat:h,lng:A},title:e,map:c,icon:f}),k=new google.maps.InfoWindow({content:a.innerHTML});d.addListener("touchend"==window.defaultClickEvent?"mousedown":window.defaultClickEvent,function(){n()});
a.addEventListener(window.defaultClickEvent,function(){n();c.panTo(d.position)});v.extend(d.getPosition());return d}function q(a){function n(k){c[d].checked=!1;k.addEventListener("change",function(){var d=!0===k.checked?!0:!1;b=d?b+1:b-1;for(var c=k.getAttribute("value"),a=0;a<e.length;a++)e[a].getAttribute("data-group")==c?h(e[a],d):0===f&&h(e[a],!1);f=1;0===t&&w(12);if(0===b)for(d=f=0;d<e.length;d++)h(e[d],!0)})}function h(d,a){0!==l&&l.close();var f=a?"block":"none";d.marker.setVisible(a);d.style.display=
f}for(var c=a.querySelectorAll('input[type="checkbox"]'),b=0,f=0,d=0;d<c.length;d++)n(c[d])}function w(a){visibleBounds=new google.maps.LatLngBounds;for(var b=0;b<e.length;b++)e[b].marker.getVisible()&&visibleBounds.extend(e[b].marker.getPosition());visibleBounds=visibleBounds.isEmpty()?v:visibleBounds;google.maps.event.addListener(c,"zoom_changed",function(){zoomChangeBoundsListener=google.maps.event.addListener(c,"bounds_changed",function(b){this.getZoom()>a&&!0===this.initialZoom&&(this.setZoom(a),
this.initialZoom=!1);google.maps.event.removeListener(zoomChangeBoundsListener)})});c.initialZoom=!0;c.fitBounds(visibleBounds)}function r(){function a(a){var d=new google.maps.Marker({map:c,position:a.geometry.location,title:a.title,icon:{url:a.icon,size:new google.maps.Size(18,18),scaledSize:new google.maps.Size(18,18)}});google.maps.event.addListener(d,"click",function(){e.getDetails(a,function(a,b){b===google.maps.places.PlacesServiceStatus.OK&&(g.setContent(a.name),g.open(c,d))})});return d}
function b(){var f=new google.maps.places.SearchBox(x);c.addListener("bounds_changed",function(){f.setBounds(c.getBounds())});var d=[];f.addListener("places_changed",function(){var b=f.getPlaces();if(0!==b.length){for(var c=0;c<d.length;c++)d[c].setMap(null);d=[];new google.maps.LatLngBounds;for(c=0;c<b.length;c++)marker=a(b[c]),d.push(marker)}})}var h={location:c.center,radius:p,types:y},e=new google.maps.places.PlacesService(c),g=new google.maps.InfoWindow;e.nearbySearch(h,function(b,d){if(d==google.maps.places.PlacesServiceStatus.OK)for(var c=
0;c<b.length;c++)a(b[c])});x&&b()}function B(){function b(a){var e=a.getElementsByTagName("location"),g=[];a=a.getAttribute("data-color");for(var f=0;f<e.length;f++)g.push(e[f].marker);e=new google.maps.DirectionsService;a=new google.maps.DirectionsRenderer({polylineOptions:{strokeColor:a}});(function(a,b,c){for(var e=[],f=0;f<a.length;f++)e[f]={location:a[f].position,stopover:0===f||f==a.length-1?!1:!0},a[f].setMap(null);b.route({origin:a[0].position,destination:a[a.length-1].position,waypoints:e,
travelMode:google.maps.TravelMode.WALKING},function(a,b){b===google.maps.DirectionsStatus.OK?c.setDirections(a):window.alert("Directions request failed due to "+b)})})(g,e,a);a.setMap(c)}for(var e=0;e<u.length;e++)b(u[e])}var e=b.getElementsByTagName("location"),u=b.getElementsByTagName("route"),g=document.createElement("div"),v=new google.maps.LatLngBounds,t=parseFloat(b.getAttribute("data-zoom")),C=parseFloat(b.getAttribute("data-lat")),D=parseFloat(b.getAttribute("data-lng")),y=b.getAttribute("data-places"),
x=b.querySelector('input[type="search"]'),z=b.getElementsByTagName("ul"),l=0;b.insertBefore(g,b.firstChild);for(var c=new google.maps.Map(g,{center:{lat:C,lng:D},zoom:t}),g=0;g<e.length;g++)e[g].marker=m(e[g]);0===t&&w(12);0<z.length&&q(z[0]);if(y){var p=b.getAttribute("data-places-range"),p=p?p:2500;r()}0<u.length&&B()}window.defaultClickEvent="ontouchstart"in document.documentElement?"touchend":"click";for(var q=document.getElementsByTagName("map"),m=0;m<q.length;m++)r(q[m])}window.initMap=initMap;